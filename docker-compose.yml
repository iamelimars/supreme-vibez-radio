version: "3"

services:
    client:
      build: ./client
      container_name: client
      image: supreme_vibez:client
      restart: always
      ports:
        - 8080:80
      volumes:
        - ./client:/client
        - /client/node_modules
      links:
        - backend
        - chat
    backend:
      container_name: express-mongo
      build: ./backend
      image: supreme_vibez:backend
      restart: always
      ports:
        - 5001:5001
      volumes:
        - ./backend:/backend
        - /backend/node_modules
      links:
        - mongo
    chat:
      build: ./chat-node
      image: supreme_vibez:chat
      container_name: chat-service
      restart: always
      ports:
        - 4000:4000
      volumes:
        - ./chat-node:/chat-node
        - /chat-node/node_modules
      links:
        - mongo
    mongo:
      container_name: mongo
      image: mongo
      ports:
        - "27017:27017"

    #     image: mhart/alpine-node:8.11.4
    #     restart: always
    #     ports:
    #         - "5000:5000"
    #     volumes:
    #         - ./backend:/backend
    #         - /backend/node_modules
    #     # depends_on:
    #     #     - mongodb
    #     networks:
    #         - webappnetwork
    
    #     image: mhart/alpine-node:8.11.4
    #     restart: always
    #     ports:
    #       - "4000:4000"
    #     volumes:
    #       - ./chat-node:/chat-node
    #       - /chat-node/node_modules
    #     # depends_on:
    #     #   - mongodb
    #     networks:
    #         - webappnetwork
    # mongodb:
    #     image: mongo
    #     restart: always
    #     container_name: mongodb
    #     ports:
    #         - 27017:27017
